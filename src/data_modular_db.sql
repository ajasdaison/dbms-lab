CREATE DATABASE IF NOT EXISTS AKSHAY_NATH;

USE AKSHAY_NATH;

-- CREATE CUSTOMER TABLE
CREATE TABLE CUSTOMER (
    CUST_ID INT PRIMARY KEY,
    CUST_NAME VARCHAR(100)
);

-- CREATE ITEM TABLE
CREATE TABLE ITEM (
    ITEM_ID INT PRIMARY KEY,
    ITEM_NAME VARCHAR(100),
    PRICE DECIMAL(10, 2)
);

-- CREATE SALE TABLE
CREATE TABLE SALE (
    BILL_NO INT PRIMARY KEY,
    BILL_DATE DATE,
    CUST_ID INT,
    ITEM_ID INT,
    QTY_SOLD INT,
    FOREIGN KEY (CUST_ID) REFERENCES CUSTOMER (CUST_ID),
    FOREIGN KEY (ITEM_ID) REFERENCES ITEM (ITEM_ID)
);


INSERT INTO CUSTOMER VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, 'Charlie'),
(4, 'David'),
(5, 'Eva'),
(6, 'Fiona'),
(7, 'George'),
(8, 'Hannah'),
(9, 'Ian'),
(10, 'Julia');

SELECT * FROM CUSTOMER;

INSERT INTO ITEM VALUES
(101, 'Laptop', 850.00),
(102, 'Mouse', 25.00),
(103, 'Keyboard', 45.00),
(104, 'Monitor', 150.00),
(105, 'Printer', 120.00),
(106, 'Scanner', 100.00),
(107, 'Headphones', 60.00),
(108, 'Webcam', 40.00),
(109, 'USB Drive', 15.00),
(110, 'Tablet', 300.00);

SELECT * FROM ITEM;

INSERT INTO SALE VALUES
(1001, '2025-09-01', 1, 101, 1),
(1002, '2025-09-02', 2, 102, 2),
(1003, '2025-09-03', 3, 103, 1),
(1004, '2025-09-04', 4, 104, 1),
(1005, '2025-09-05', 5, 105, 1),
(1006, '2025-09-06', 6, 106, 1),
(1007, '2025-09-07', 7, 107, 2),
(1008, '2025-09-08', 8, 108, 1),
(1009, '2025-09-09', 9, 109, 3),
(1010, '2025-09-10', 10, 110, 1);

SELECT * FROM SALE;

SELECT
    B.BILL_NO,
    B.BILL_DATE,
    C.CUST_NAME,
    I.ITEM_ID
FROM SALE AS B
INNER JOIN CUSTOMER AS C ON B.CUST_ID = C.CUST_ID
INNER JOIN ITEM AS I ON B.ITEM_ID = I.ITEM_ID
WHERE B.BILL_DATE = CURDATE();

SELECT
    I.ITEM_NAME,
    I.PRICE,
    B.QTY_SOLD,
    B.QTY_SOLD * I.PRICE AS FINAL_AMOUNT
FROM
    SALE AS B
INNER JOIN
    ITEM AS I
    ON B.ITEM_ID = I.ITEM_ID;

SELECT DISTINCT C.CUST_NAME
FROM SALE AS S
INNER JOIN CUSTOMER AS C ON S.CUST_ID = C.CUST_ID
INNER JOIN ITEM AS I ON S.ITEM_ID = I.ITEM_ID
WHERE I.PRICE > 200;

SELECT
    C.CUST_NAME,
    COUNT(I.ITEM_ID)
FROM SALE AS S
INNER JOIN CUSTOMER AS C ON S.CUST_ID = C.CUST_ID
INNER JOIN ITEM AS I ON S.ITEM_ID = I.ITEM_ID
GROUP BY C.CUST_NAME;

SELECT
    C.CUST_NAME,
    COUNT(DISTINCT I.ITEM_ID)
FROM SALE AS S
INNER JOIN CUSTOMER AS C ON S.CUST_ID = C.CUST_ID
INNER JOIN ITEM AS I ON S.ITEM_ID = I.ITEM_ID
GROUP BY C.CUST_NAME;

SELECT
    C.CUST_ID,
    I.ITEM_NAME
FROM SALE
INNER JOIN CUSTOMER AS C ON SALE.CUST_ID = C.CUST_ID
INNER JOIN ITEM AS I USING (ITEM_ID)
WHERE C.CUST_ID = 5;

SELECT
S.BILL_NO,
C.CUST_ID,
S.QTY_SOLD,
I.ITEM_NAME,
I.PRICE
FROM SALE AS S
INNER JOIN CUSTOMER AS C ON S.CUST_ID = C.CUST_ID
INNER JOIN ITEM AS I USING (ITEM_ID)
WHERE S.BILL_DATE = CURDATE();
